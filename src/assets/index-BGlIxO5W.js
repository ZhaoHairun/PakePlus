import{_ as G}from"./arco-table-D7Ntzbsx.js";import{_ as X}from"./arco-icon-CunFPY5n.js";import{a as z,i as Y,l as J,s as Z}from"./index-DP0JwgWw.js";import{E as D}from"./api-CmsgK-9p.js";import{d as A,I as V,y as B,r as S,p as P,s as F,f as $,c as p,o as s,e as b,u as n,w as y,b as t,n as j,t as _,J as tt,_ as R,F as L,m as N,h as x,H as E,z as T,K as et,A as nt,L as at,M as st,a as O,N as ot,O as it,P as lt,q as U,i as H}from"./index-B3mkc1PU.js";import{P as dt}from"./previewPDF-DiIaB3wn.js";import{u as ct,_ as M}from"./useRenderModal-BiI04mzw.js";const rt={class:"tree"},ut=A({__name:"tree",emits:["click-doc","drop-doc"],setup(C,{expose:m,emit:i}){const o=V("id"),h=B("TreeRef"),d=S({data:{list:[],expandedKeys:[]}}),r=async()=>{const{data:a}=await D.getProAndDocListApi(o);for(let c=0;c<a.length;c++){a[c].type="parent";for(let u=0;u<a[c].writList.length;u++)a[c].writList[u].type="child"}d.data.list=a,await tt(),h.value.expandAll(!0)},e=P(()=>a=>a.type==="parent"?`${a.name}(${a.writList.length||0})`:a.name),l=i,f=a=>{var k;const{dropNode:c,dropPosition:u}=a;if(c.type==="parent"&&u!==0||c.type==="child"&&u===0)return!1;if(c.type==="child"&&u===1){const v=c.deptProgressId||c.id,I=((k=d.data.list.find(W=>W.id===v))==null?void 0:k.writList)||[];return I[I.length-1].id===c.id}return!0},g=a=>{var W;const{dragNode:c,dropNode:u,dropPosition:k}=a;if(c.type==="parent"&&k===0||c.type==="parent"&&u.type==="child"){z("error",{content:"不能将流程放置到流程之内"});return}if(c.type==="parent"&&u.type==="parent"){z("warning",{content:"流程之间暂不支持进行排序"});return}if(u.type==="parent"&&u.id===c.deptProgressId){z("error",{content:"该文书已经在该流程内"});return}const v=u.deptProgressId||u.id,I=((W=d.data.list.find(q=>q.id===v))==null?void 0:W.writList)||[],Q=I.filter(q=>q.id!==c.id);let K=I.length;u.type==="child"&&(k===1?u.deptProgressId===c.deptProgressId&&K--:K=Q.findIndex(q=>q.id===u.id)),l("drop-doc",{id:c.id,dossierWritId:c.dossierWritId,deptProcessId:v,sort:K})},w=(a,c)=>{if(c.node.type==="parent"){h.value.expandNode(c.node.id,!d.data.expandedKeys.includes(c.node.id));return}l("click-doc",c.node)};return m({getTree:r}),F(()=>{r()}),(a,c)=>{const u=$("a-tree");return s(),p("div",rt,[b(u,{ref_key:"TreeRef",ref:h,"expanded-keys":n(d).data.expandedKeys,"onUpdate:expandedKeys":c[0]||(c[0]=k=>n(d).data.expandedKeys=k),data:n(d).data.list,"show-line":!0,draggable:!1,"default-expand-all":!0,"field-names":{key:"id",title:"name",children:"writList"},"allow-drop":f,onDrop:g,onSelect:w},{title:y(k=>[t("span",{class:j(["tree-title",{"red-text":k.redStatus}])},_(n(e)(k)),3)]),_:1},8,["expanded-keys","data"])])}}}),pt=R(ut,[["__scopeId","data-v-d14b5497"]]),_t={class:"basic-container"},mt={class:"basic"},ft={class:"detail-container-content"},ht={class:"detail-container-content-item blue full"},vt={class:"detail-container-content-item-value"},yt={class:"detail-container-content-item full"},gt={class:"detail-container-content-item-value"},wt={class:"detail-container-content-item"},kt={class:"detail-container-content-item-value"},bt={class:"detail-container-content-item"},$t={class:"detail-container-content-item-value"},Ct={class:"detail-container-content-item"},xt={class:"detail-container-content-item-value"},Lt={class:"detail-container-content-item"},Tt={class:"detail-container-content-item-value"},It={class:"detail-container-content-item full"},Nt={class:"detail-container-content-item-value"},Dt={class:"detail-container-content-item full"},St={class:"detail-container-content-item-value"},Pt={class:"detail-container-content-item full"},At={class:"detail-container-content-item-value"},Rt={class:"detail-container-content-item full"},qt={class:"detail-container-content-item-value"},zt={class:"detail-container-content-item full"},Ft={class:"detail-container-content-item-value"},Kt={class:"detail-container-content-item full"},Wt={class:"detail-container-content-item-value"},Et={class:"basic"},Vt={class:"basic-content"},Mt={class:"basic-content-item"},Bt=A({__name:"basic",setup(C){const m=V("id"),i=S({data:{info:{},timeLine:[],timePending:!0}}),o=async()=>{const{data:r}=await D.getEvaluationDetailApi(m);i.data.info=r},h=async()=>{const{data:r}=await D.getTimelineApi(m);i.data.timeLine=r,i.data.timePending=!1},d=P(()=>{const r=[];for(let e=0;e<i.data.timeLine.length;e++)r.push(`于${i.data.timeLine[e].timeLine}${i.data.timeLine[e].name}`);return r.join(" -> ")});return F(()=>{o(),h()}),(r,e)=>(s(),p("div",_t,[t("div",mt,[e[12]||(e[12]=t("div",{class:"basic-title"},"案卷信息",-1)),t("div",ft,[t("div",ht,[e[0]||(e[0]=t("p",{class:"detail-container-content-item-label"},"案卷名称：",-1)),t("p",vt,_(n(i).data.info.name),1)]),t("div",yt,[e[1]||(e[1]=t("p",{class:"detail-container-content-item-label"},"案卷编号：",-1)),t("p",gt,_(n(i).data.info.code),1)]),t("div",wt,[e[2]||(e[2]=t("p",{class:"detail-container-content-item-label"},"当事人：",-1)),t("p",kt,_(n(i).data.info.dsrName),1)]),t("div",bt,[e[3]||(e[3]=t("p",{class:"detail-container-content-item-label"},"执法人员：",-1)),t("p",$t,_(n(i).data.info.zfyName),1)]),t("div",Ct,[e[4]||(e[4]=t("p",{class:"detail-container-content-item-label"},"区域：",-1)),t("p",xt,_(n(i).data.info.areaName),1)]),t("div",Lt,[e[5]||(e[5]=t("p",{class:"detail-container-content-item-label"},"部门：",-1)),t("p",Tt,_(n(i).data.info.deptName),1)]),t("div",It,[e[6]||(e[6]=t("p",{class:"detail-container-content-item-label"},"案由：",-1)),t("p",Nt,_(n(i).data.info.anyou),1)]),t("div",Dt,[e[7]||(e[7]=t("p",{class:"detail-container-content-item-label"},"违法地点：",-1)),t("p",St,_(n(i).data.info.wfAddress),1)]),t("div",Pt,[e[8]||(e[8]=t("p",{class:"detail-container-content-item-label"},"违法内容：",-1)),t("p",At,_(n(i).data.info.wfContent),1)]),t("div",Rt,[e[9]||(e[9]=t("p",{class:"detail-container-content-item-label"},"裁量权基准：",-1)),t("p",qt,_(n(i).data.info.discretionStandard),1)]),t("div",zt,[e[10]||(e[10]=t("p",{class:"detail-container-content-item-label"},"违法条款：",-1)),t("p",Ft,_(n(i).data.info.illegalClause),1)]),t("div",Kt,[e[11]||(e[11]=t("p",{class:"detail-container-content-item-label"},"处罚条款：",-1)),t("p",Wt,_(n(i).data.info.penalClause),1)])])]),t("div",Et,[e[13]||(e[13]=t("div",{class:"basic-title"},"案卷时间线",-1)),t("div",Vt,[t("span",Mt,_(n(d)),1)])])]))}}),jt=R(Bt,[["__scopeId","data-v-58d99cce"]]),Qt={class:"issues-container"},Ot={class:"question-title"},Ut={key:0},Ht={class:"child-question-title"},Jt={key:0,class:"keyword-container"},Gt={class:"keyword-content"},Xt={class:"keyword-content-item-key"},Yt={key:0,class:"other-keyword-content"},Zt={key:1,class:"keyword-content-item-value"},te={key:1,class:"question-container"},ee={class:"question-content"},ne=A({__name:"document-list",setup(C){const m=V("id"),i=S({data:{list:[]}}),o=async()=>{const{data:d}=await D.getDocQuestionListApi(m);i.data.list=d},h=P(()=>d=>Array.isArray(d)?d.join("、"):d);return F(()=>{o()}),(d,r)=>{const e=$("a-empty"),l=$("a-collapse-item"),f=$("a-collapse");return s(),p("div",Qt,[b(f,{bordered:!0,"destroy-on-hide":!0},{default:y(()=>[(s(!0),p(L,null,N(n(i).data.list,(g,w)=>(s(),x(l,{key:w},{header:y(()=>[t("span",Ot,_(g.proName),1)]),default:y(()=>[g.dataList.length?(s(),p("div",Ut,[(s(!0),p(L,null,N(g.dataList,(a,c)=>(s(),x(f,{key:c,bordered:!1,"destroy-on-hide":!0},{default:y(()=>[b(l,null,{header:y(()=>[t("span",Ht,_(a.writName),1)]),default:y(()=>[a.keyword.length||a.questionList.length?(s(),p(L,{key:0},[a.keyword.length?(s(),p("div",Jt,[r[0]||(r[0]=t("p",{class:"keyword-content-title"},"关键词提取内容",-1)),t("div",Gt,[(s(!0),p(L,null,N(a.keyword,(u,k)=>(s(),p("div",{key:k,class:j(["keyword-content-item",{other:a.writName.includes("案卷目录")}])},[t("p",Xt,_(u.key)+"：",1),a.writName.includes("案卷目录")?(s(),p("div",Yt,[(s(!0),p(L,null,N(u.value,(v,I)=>(s(),p("p",{key:I,class:"other-keyword-content-item-value"},_(v.name)+"："+_(v.time),1))),128))])):(s(),p("p",Zt,_(n(h)(u.value)),1))],2))),128))])])):E("",!0),a.questionList.length?(s(),p("div",te,[r[1]||(r[1]=t("p",{class:"question-content-title"},"本文书涉及问题",-1)),t("div",ee,[(s(!0),p(L,null,N(a.questionList,(u,k)=>(s(),p("p",{key:k,class:"question-content-item"},_(k+1)+"、"+_(u.content),1))),128))])])):E("",!0)],64)):(s(),x(e,{key:1}))]),_:2},1024)]),_:2},1024))),128))])):(s(),x(e,{key:1}))]),_:2},1024))),128))]),_:1})])}}}),ae=R(ne,[["__scopeId","data-v-ff211d72"]]),se={class:"issues-container"},oe={class:"question-title"},ie={key:0},le={class:"child-question-title"},de={key:0},ce={key:0},re=A({__name:"issues",setup(C){const m=V("id"),i=S({data:{list:[],columns:[{title:"评查内容",render({record:d}){return T("span",{style:"color: #333333"},`${d.code}、${d.content}`)},headerCellClass:"question-table-header-cell"},{title:"涉及文书",render({record:d}){return T("span",{style:"color: #206FFC"},d.writNames)},headerCellClass:"question-table-header-cell"},{title:"发现问题",render({record:d}){return T("span",{style:"color: #FF0000"},d.remark)},headerCellClass:"question-table-header-cell"},{title:"扣除分数",render({record:d}){return T("span",{style:"color: #FF0000"},`-${d.score}分`)},align:"center",fixed:"right",width:100,headerCellClass:"question-table-header-cell"}]}}),o=async()=>{const{data:d}=await D.getQuestionListApi(m);i.data.list=d},h=P(()=>d=>{const{code:r,content:e,count:l}=d;return`${r}、${e} (${l})`});return F(()=>{o()}),(d,r)=>{const e=$("a-table"),l=$("a-empty"),f=$("a-collapse-item"),g=$("a-collapse");return s(),p("div",se,[b(g,{bordered:!0,"destroy-on-hide":!0},{default:y(()=>[(s(!0),p(L,null,N(n(i).data.list,w=>(s(),x(f,{key:w.code},{header:y(()=>[t("span",oe,_(n(h)(w)),1)]),default:y(()=>[w.childList.length||w.itemList.length?(s(),p("div",ie,[(s(!0),p(L,null,N(w.childList,a=>(s(),x(g,{key:a.code,bordered:!1,"destroy-on-hide":!0},{default:y(()=>[b(f,null,{header:y(()=>[t("span",le,_(n(h)(a)),1)]),default:y(()=>[a.childList.length?(s(),p("div",de,[b(e,{data:a.childList,columns:n(i).data.columns,scroll:{x:"100%"},"table-layout-fixed":!0,pagination:!1},null,8,["data","columns"])])):(s(),x(l,{key:1}))]),_:2},1024)]),_:2},1024))),128)),w.itemList.length?(s(),p("div",ce,[b(e,{data:w.itemList,columns:n(i).data.columns,scroll:{x:"100%"},"table-layout-fixed":!0,pagination:!1},null,8,["data","columns"])])):E("",!0)])):(s(),x(l,{key:1}))]),_:2},1024))),128))]),_:1})])}}}),ue=R(re,[["__scopeId","data-v-366e0ecb"]]),pe={};function _e(C,m){return"总结报告"}const me=R(pe,[["render",_e]]),fe={class:"container"},he={class:"detail-content-container"},ve={class:"detail-content"},ye={class:"detail-steps-container"},ge={class:"step"},we={class:"step-icon"},ke=["onClick"],be={class:"step-title"},$e={class:"detail-component-container"},Ce={class:"detail-component"},xe={class:"detail-tree-container"},Le={class:"tree-container"},Te={class:"tree-content"},Ie=A({__name:"detail",props:{id:{default:""}},setup(C,{expose:m}){et("id",C.id);const o=S({data:{list:["基础信息","文书清单","问题清单","总结报告"],current:0}}),h=P(()=>({0:jt,1:ae,2:ue,3:me})[o.data.current]),d=P(()=>f=>{const w=f<=o.data.current?"checked":"unchecked";return{display:"block",width:"64px",height:"64px",backgroundImage:`url(${`${Y(`images/png/steps-${f}-${w}-icon.png`)}`})`,backgroundSize:"100% 100%"}}),r=B("TreeRef"),e=async f=>{await D.moveDocToProApi(f),r.value&&r.value.getTree()},l=f=>{const{toggleVisible:g}=ct({component:dt,props:{url:f.filePath,name:f.name},modalProps:{title:f.name,width:1e3,draggable:!0,hideCancel:!0},modalSlots:{footer:()=>[T(M,{onClick:g},{default:()=>"关闭"})]}})};return m({prev(){o.data.current=Math.max(0,o.data.current-1)},next(){o.data.current=Math.min(o.data.list.length-1,o.data.current+1)}}),(f,g)=>(s(),p("div",fe,[t("div",he,[t("div",ve,[t("div",ye,[(s(!0),p(L,null,N(n(o).data.list,(w,a)=>(s(),p("div",{class:j(["detail-step",{active:a<=n(o).data.current}]),key:a},[t("div",ge,[t("div",we,[t("i",{style:nt(n(d)(a)),onClick:c=>n(o).data.current=a},null,12,ke)]),t("span",be,_(w),1)])],2))),128))]),t("div",$e,[t("div",Ce,[(s(),x(st,null,[(s(),x(at(n(h))))],1024))])])])]),t("div",xe,[g[0]||(g[0]=t("p",{class:"tree-title"},"案卷文书列表",-1)),t("div",Le,[t("div",Te,[b(pt,{ref_key:"TreeRef",ref:r,onDropDoc:e,onClickDoc:l},null,512)])])])]))}}),Ne=R(Ie,[["__scopeId","data-v-6f76bd65"]]),De=C=>{const m=O(),i=O(!0),o=()=>{i.value=!i.value},h=()=>{r.unmount(),document.body.removeChild(e)},r=ot(()=>T(lt,{...C.drawerProps,popupContainer:".main-container",visible:i.value,escToClose:!1,maskClosable:!1,unmountOnClose:!0,onBeforeCancel(){return!J.value},onCancel(){i.value=!1},onClose(){h()}},{default:()=>T(C.component,{ref:m,...C.props}),...C.drawerSlots||{}}));it(r);const e=document.createElement("div");return document.body.appendChild(e),r.mount(e),{instance:m,unmount:h,toggleVisible:o}},Se={class:"filter-content"},Pe={class:"select-content"},Ae={class:"search-content"},Re={class:"search-content-buttons"},qe={class:"search"},ze={class:"refresh"},je=A({__name:"index",setup(C){const m=S({data:{state:{options:[{label:"评查中",value:1},{label:"已评查",value:2}],value:""},keyword:""}}),i=B("table"),o=S({data:{columns:[{title:"案卷名称",dataIndex:"dossierName",align:"center",fixed:"left",width:300,minWidth:200},{title:"编号",dataIndex:"code",align:"center",width:200,minWidth:100},{title:"所属区域",dataIndex:"areaName",align:"center",width:200,minWidth:100},{title:"所属部门",dataIndex:"deptName",align:"center",width:200,minWidth:100},{title:"上传时间",dataIndex:"createTime",align:"center",width:200,minWidth:100},{title:"状态",align:"center",render({record:e}){const l=[{text:"未评查",color:"#FF0000"},{text:"评查中",color:"#206FFC"},{text:"已评查",color:"#39CA3A"}];return T("span",{style:`color: ${l[e.status].color}`},l[e.status].text)},fixed:"right",width:100,minWidth:100,headerCellClass:"hide-resizable"},{title:"操作",slotName:"optional",align:"center",fixed:"right",width:150,minWidth:150}],list:[],pagination:{show:!0,total:0,pageNum:1,pageSize:10},tableRowSelection:{width:40,type:"checkbox",selectedRowKeys:[],showCheckedAll:!0}}}),h=async()=>{const{data:e}=await D.getEvaluationListApi({status:m.data.state.value,keyword:m.data.keyword,pageNum:o.data.pagination.pageNum,pageSize:o.data.pagination.pageSize}),{currentList:l,totalRecords:f}=e;o.data.list=l,o.data.pagination.total=f};U(()=>[m.data.state.value,m.data.keyword,o.data.pagination.pageSize],()=>{o.data.pagination.pageNum>1?o.data.pagination.pageNum=1:h()}),U(()=>o.data.pagination.pageNum,h);const d=e=>{Z("warning",{title:"删除",content:"确认删除该评查吗？",okText:"确认",hideCancel:!1,onOk:async()=>{try{await D.deleteEvaluationApi(e),z("success",{content:"删除成功"}),h()}catch{z("error",{content:"删除失败"})}}})},r=e=>{const{instance:l}=De({component:Ne,props:{id:e},drawerProps:{title:"案卷文书评查详细报告",placement:"bottom",height:"100%"},drawerSlots:{footer:()=>[T(M,{onClick(){l.value.prev()}},{default:()=>"上一步"}),T(M,{type:"primary",onClick(){l.value.next()}},{default:()=>"下一步"})]}})};return F(()=>{h()}),(e,l)=>{const f=$("a-select"),g=$("a-space"),w=X,a=$("a-input-search"),c=$("icon-sync"),u=$("a-link"),k=G;return s(),p(L,null,[t("div",Se,[t("div",Pe,[b(f,{"model-value":n(m).data.state.value,"onUpdate:modelValue":l[0]||(l[0]=v=>n(m).data.state.value=v),options:n(m).data.state.options,style:{width:"200px"},"allow-clear":"",placeholder:"选择状态"},null,8,["model-value","options"])]),t("div",Ae,[b(g,null,{default:y(()=>[t("div",Re,[b(g)]),t("div",qe,[b(a,{"default-value":n(m).data.keyword,"allow-clear":"","search-button":"","button-text":"查询",placeholder:"输入关键字搜索",onChange:l[1]||(l[1]=v=>n(m).data.keyword=v)},{"button-icon":y(()=>[b(w,{icon:"icon-search"})]),_:1},8,["default-value"])]),t("div",ze,[b(c,{spin:n(J),onClick:h},null,8,["spin"])])]),_:1})])]),b(k,{ref_key:"table",ref:i,"row-key":"id","selected-keys":n(o).data.tableRowSelection.selectedRowKeys,"onUpdate:selectedKeys":l[2]||(l[2]=v=>n(o).data.tableRowSelection.selectedRowKeys=v),"row-selection":n(o).data.tableRowSelection,columns:n(o).data.columns,data:n(o).data.list,pagination:n(o).data.pagination,"column-resizable":!0,onCurrentChange:l[3]||(l[3]=v=>n(o).data.pagination.pageNum=v),onPageSizeChange:l[4]||(l[4]=v=>n(o).data.pagination.pageSize=v)},{optional:y(({record:v})=>[b(g,{size:"medium"},{default:y(()=>[[2].includes(v.status)?(s(),x(u,{key:0,status:"danger",hoverable:!1,onClick:I=>d(v.id)},{default:y(()=>l[5]||(l[5]=[H(" 删除 ",-1)])),_:2,__:[5]},1032,["onClick"])):E("",!0),b(u,{hoverable:!1,onClick:I=>r(v.id)},{default:y(()=>l[6]||(l[6]=[H(" 查看 ",-1)])),_:2,__:[6]},1032,["onClick"])]),_:2},1024)]),_:1},8,["selected-keys","row-selection","columns","data","pagination"])],64)}}});export{je as default};
