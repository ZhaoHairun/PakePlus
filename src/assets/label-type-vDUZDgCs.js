import{_ as B}from"./arco-table-D7Ntzbsx.js";import{_ as A}from"./arco-icon-CunFPY5n.js";import{_ as J,u as V}from"./useRenderModal-BiI04mzw.js";import{J as b}from"./api-CmsgK-9p.js";import{l as $,s as F,a as v}from"./index-DP0JwgWw.js";import{d as C,a as M,r as h,s as N,B as O,f as c,h as D,o as S,w as l,e as s,u as t,y as I,q as x,c as K,b as g,F as U,i as k}from"./index-B3mkc1PU.js";const W=C({__name:"add-label-type",props:{id:{default:""}},setup(T,{expose:u}){const _=T,a=M(),o=h({data:{form:{id:"",name:"",score:0},rules:{name:[{required:!0,message:"请输入评判标签类型"}],score:[{required:!0,message:"请输入最高扣除分数"},{validator:(r,n)=>{n(r<=0?"请输入最高扣除分数":"")}}]}}}),f=async()=>{const{data:r}=await b.getJudgementTagTypeDetailApi(_.id);Object.assign(o.data.form,{id:r.id,name:r.name,score:r.score})};return u({form:o.data.form,async submit(){return await a.value.validate()}}),N(()=>{_.id&&f()}),O(()=>{a.value.resetFields(Object.keys(o.data.form))}),(r,n)=>{const e=c("a-input"),d=c("a-form-item"),m=c("a-input-number"),y=c("a-form"),w=c("a-scrollbar");return S(),D(w,{style:{maxHeight:"calc(100vh - 250px)",overflow:"auto"}},{default:l(()=>[s(y,{ref_key:"form",ref:a,model:t(o).data.form,rules:t(o).data.rules,disabled:t($),"auto-label-width":"","scroll-to-first-error":""},{default:l(()=>[s(d,{label:"评判标签类型",field:"name"},{default:l(()=>[s(e,{"model-value":t(o).data.form.name,"onUpdate:modelValue":n[0]||(n[0]=p=>t(o).data.form.name=p),placeholder:"请输入评判标签类型"},null,8,["model-value"])]),_:1}),s(d,{label:"最高扣除分数",field:"score"},{default:l(()=>[s(m,{"model-value":t(o).data.form.score,"onUpdate:modelValue":n[1]||(n[1]=p=>t(o).data.form.score=p),min:0,precision:2,placeholder:"请输入最高扣除分数"},null,8,["model-value"])]),_:1})]),_:1},8,["model","rules","disabled"])]),_:1})}}}),q={class:"filter-content"},j={class:"search-content"},E={class:"search-content-buttons"},L={class:"search"},Z=C({__name:"label-type",setup(T){const u=h({data:{keyword:""}}),_=I("table"),a=h({data:{columns:[{title:"评判标签类型",dataIndex:"name",align:"center",minWidth:200},{title:"最高扣分",dataIndex:"score",align:"center",minWidth:200},{title:"添加时间",dataIndex:"createTime",align:"center",minWidth:200},{title:"操作",slotName:"optional",align:"center",fixed:"right",minWidth:200}],list:[],pagination:{show:!0,total:0,pageNum:1,pageSize:10},tableRowSelection:{width:40,type:"checkbox",selectedRowKeys:[],showCheckedAll:!0}}}),o=async()=>{const{data:n}=await b.getJudgementTagTypeListApi({keyword:u.data.keyword,pageNum:a.data.pagination.pageNum,pageSize:a.data.pagination.pageSize}),{currentList:e,totalRecords:d}=n;a.data.list=e,a.data.pagination.total=d};x(()=>[u.data.keyword,a.data.pagination.pageSize],()=>{a.data.pagination.pageNum>1?a.data.pagination.pageNum=1:o()}),x(()=>a.data.pagination.pageNum,o);const f=n=>{const{instance:e,toggleVisible:d}=V({component:W,props:{id:n},modalProps:{title:n?"编辑评判标签类型":"新增评判标签类型",draggable:!0,async onBeforeOk(){try{await e.value.submit()||(await b.addJudgementTagTypeApi(e.value.form),v("success",{content:"添加成功"}),o(),d())}catch{return!1}}}})},r=n=>{F("warning",{title:"删除",content:"确认删除该评判标签类型吗？",okText:"确认",hideCancel:!1,onOk:async()=>{try{await b.deleteJudgementTagTypeApi(n),v("success",{content:"删除成功"}),o()}catch{v("error",{content:"删除失败"})}}})};return N(()=>{o()}),(n,e)=>{const d=J,m=c("a-space"),y=A,w=c("a-input-search"),p=c("a-link"),R=B;return S(),K(U,null,[g("div",q,[g("div",j,[s(m,null,{default:l(()=>[g("div",E,[s(m,null,{default:l(()=>[s(d,{type:"primary",onClick:e[0]||(e[0]=i=>f(""))},{default:l(()=>e[5]||(e[5]=[k(" 添加 ",-1)])),_:1,__:[5]})]),_:1})]),g("div",L,[s(w,{"default-value":t(u).data.keyword,"allow-clear":"","search-button":"","button-text":"查询",placeholder:"输入关键字搜索",onChange:e[1]||(e[1]=i=>t(u).data.keyword=i)},{"button-icon":l(()=>[s(y,{icon:"icon-search"})]),_:1},8,["default-value"])])]),_:1})])]),s(R,{ref_key:"table",ref:_,"row-key":"id","selected-keys":t(a).data.tableRowSelection.selectedRowKeys,"onUpdate:selectedKeys":e[2]||(e[2]=i=>t(a).data.tableRowSelection.selectedRowKeys=i),"row-selection":t(a).data.tableRowSelection,columns:t(a).data.columns,data:t(a).data.list,pagination:t(a).data.pagination,"column-resizable":!0,onCurrentChange:e[3]||(e[3]=i=>t(a).data.pagination.pageNum=i),onPageSizeChange:e[4]||(e[4]=i=>t(a).data.pagination.pageSize=i)},{optional:l(({record:i})=>[s(m,{size:"medium"},{default:l(()=>[s(p,{status:"warning",hoverable:!1,onClick:z=>f(i.id)},{default:l(()=>e[6]||(e[6]=[k(" 编辑 ",-1)])),_:2,__:[6]},1032,["onClick"]),s(p,{status:"danger",hoverable:!1,onClick:z=>r(i.id)},{default:l(()=>e[7]||(e[7]=[k(" 删除 ",-1)])),_:2,__:[7]},1032,["onClick"])]),_:2},1024)]),_:1},8,["selected-keys","row-selection","columns","data","pagination"])],64)}}});export{Z as default};
