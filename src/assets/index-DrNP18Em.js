import{_ as $}from"./arco-table-D7Ntzbsx.js";import{_ as M}from"./arco-icon-CunFPY5n.js";import{_ as O,u as D}from"./useRenderModal-BiI04mzw.js";import{c as k,J as A,b as F}from"./api-CmsgK-9p.js";import{l as K,s as j,a as z}from"./index-DP0JwgWw.js";import{d as B,a as E,r as b,s as W,B as P,f as m,h as H,o as q,w as c,e as o,u as e,b as g,y as G,q as U,c as Q,F as X,i as V}from"./index-B3mkc1PU.js";const Y=B({__name:"add",props:{id:{default:""}},setup(R,{expose:a}){const y=R,v=E(),l=b({data:{form:{id:"",bankCateId:"",firstLabelId:"",secondLabelId:"",code:"",content:"",score:0},rules:{bankCateId:[{required:!0,message:"请选择评判标签类型"}],firstLabelId:[{required:!0,message:"请选择一级标签"}],code:[{required:!0,message:"请输入编号"}],content:[{required:!0,message:"请输入内容"}],score:[{required:!0,message:"请输入评判项分数"},{validator:(n,s)=>{s(n<=0?"请输入评判项分数":"")}}]}}}),T=async()=>{const{data:n}=await k.getJudgementDetailApi(y.id);Object.assign(l.data.form,{id:n.id,bankCateId:n.bankCateId,firstLabelId:n.firstLabelId,secondLabelId:n.secondLabelId,code:n.code,content:n.content,score:n.score}),n.bankCateId&&_(),n.firstLabelId&&t()},L=b({data:{options:[],fieldNames:{label:"name",value:"id"}}}),I=async()=>{const{data:n}=await A.getJudgementTagTypeListApi({keyword:"",pageNum:1,pageSize:9999});L.data.options=n.currentList},C=n=>{p.data.options.length=0,l.data.form.firstLabelId="",d.data.options.length=0,l.data.form.secondLabelId="",n&&_()},i=async(n,s)=>await F.getJudgementTagListApi({level:n,bankCateId:l.data.form.bankCateId,parentId:s,keyword:"",pageNum:1,pageSize:9999}),p=b({data:{options:[],fieldNames:{label:"content",value:"id"}}}),_=async()=>{const{data:n}=await i("1","");p.data.options=n.currentList},x=n=>{d.data.options.length=0,l.data.form.secondLabelId="",n&&t()},d=b({data:{options:[],fieldNames:{label:"content",value:"id"}}}),t=async()=>{const{data:n}=await i("2",l.data.form.firstLabelId);d.data.options=n.currentList};return a({form:l.data.form,async submit(){return await v.value.validate()}}),W(()=>{I(),y.id&&T()}),P(()=>{v.value.resetFields(Object.keys(l.data.form))}),(n,s)=>{const w=m("a-select"),f=m("a-form-item"),N=m("a-input"),h=m("a-textarea"),J=m("a-input-number"),r=m("a-form"),S=m("a-scrollbar");return q(),H(S,{style:{maxHeight:"calc(100vh - 250px)",overflow:"auto"}},{default:c(()=>[o(r,{ref_key:"form",ref:v,model:e(l).data.form,rules:e(l).data.rules,disabled:e(K),"auto-label-width":"","scroll-to-first-error":""},{default:c(()=>[o(f,{label:"评判标签类型",field:"bankCateId"},{default:c(()=>[o(w,{"model-value":e(l).data.form.bankCateId,"onUpdate:modelValue":s[0]||(s[0]=u=>e(l).data.form.bankCateId=u),options:e(L).data.options,"field-names":e(L).data.fieldNames,"allow-clear":"",placeholder:"请选择评判标签类型",onChange:C},null,8,["model-value","options","field-names"])]),_:1}),o(f,{label:"一级标签",field:"firstLabelId"},{default:c(()=>[o(w,{"model-value":e(l).data.form.firstLabelId,"onUpdate:modelValue":s[1]||(s[1]=u=>e(l).data.form.firstLabelId=u),options:e(p).data.options,"field-names":e(p).data.fieldNames,"allow-clear":"",placeholder:"请选择一级标签",onChange:x},null,8,["model-value","options","field-names"])]),_:1}),o(f,{label:"二级标签",field:"secondLabelId"},{extra:c(()=>s[6]||(s[6]=[g("span",null,"如果没有此内容请不要选择二级标签",-1)])),default:c(()=>[o(w,{"model-value":e(l).data.form.secondLabelId,"onUpdate:modelValue":s[2]||(s[2]=u=>e(l).data.form.secondLabelId=u),options:e(d).data.options,"field-names":e(d).data.fieldNames,"allow-clear":"",placeholder:"请选择二级标签"},null,8,["model-value","options","field-names"])]),_:1}),o(f,{label:"编号",field:"code"},{default:c(()=>[o(N,{"model-value":e(l).data.form.code,"onUpdate:modelValue":s[3]||(s[3]=u=>e(l).data.form.code=u),placeholder:"请输入编号"},null,8,["model-value"])]),_:1}),o(f,{label:"内容",field:"content"},{default:c(()=>[o(h,{"model-value":e(l).data.form.content,"onUpdate:modelValue":s[4]||(s[4]=u=>e(l).data.form.content=u),"auto-size":{minRows:2,maxRows:10},"allow-clear":"",placeholder:"请输入内容"},null,8,["model-value"])]),_:1}),o(f,{label:"评判项分数",field:"score"},{default:c(()=>[o(J,{"model-value":e(l).data.form.score,"onUpdate:modelValue":s[5]||(s[5]=u=>e(l).data.form.score=u),min:0,precision:2,placeholder:"请输入评判项分数"},null,8,["model-value"])]),_:1})]),_:1},8,["model","rules","disabled"])]),_:1})}}}),Z={class:"filter-content"},ee={class:"select-content"},ae={class:"search-content"},te={class:"search-content-buttons"},ne={class:"search"},ce=B({__name:"index",setup(R){const a=b({data:{JudgementTagType:{fieldNames:{label:"name",value:"id"},options:[],value:""},firstLabel:{options:[],value:"",fieldNames:{label:"content",value:"id"}},secondLabel:{options:[],value:"",fieldNames:{label:"content",value:"id"}},keyword:""}}),y=async()=>{const{data:d}=await A.getJudgementTagTypeListApi({keyword:"",pageNum:1,pageSize:9999});a.data.JudgementTagType.options=d.currentList},v=d=>{a.data.firstLabel.options.length=0,a.data.firstLabel.value="",a.data.secondLabel.options.length=0,a.data.secondLabel.value="",d&&T()},l=async(d,t)=>await F.getJudgementTagListApi({level:d,bankCateId:a.data.JudgementTagType.value,parentId:t,keyword:"",pageNum:1,pageSize:9999}),T=async()=>{const{data:d}=await l("1","");a.data.firstLabel.options=d.currentList},L=d=>{a.data.secondLabel.options.length=0,a.data.secondLabel.value="",d&&I()},I=async()=>{const{data:d}=await l("2",a.data.firstLabel.value);a.data.secondLabel.options=d.currentList},C=G("table"),i=b({data:{columns:[{title:"评判编号",dataIndex:"code",align:"center",fixed:"left",width:100,minWidth:100},{title:"评判标准",dataIndex:"content",align:"center",width:300,minWidth:200},{title:"评判分数",dataIndex:"score",align:"center",width:100,minWidth:100},{title:"评判标签类型",dataIndex:"bankCateName",align:"center",width:200,minWidth:200},{title:"一级标签",dataIndex:"firstLabelContent",align:"center",width:200,minWidth:200},{title:"二级标签",dataIndex:"secondLabelContent",align:"center",width:200,minWidth:200},{title:"添加时间",dataIndex:"createTime",align:"center",width:200,minWidth:200},{title:"操作",slotName:"optional",align:"center",fixed:"right",width:200,minWidth:200}],list:[],pagination:{show:!0,total:0,pageNum:1,pageSize:10},tableRowSelection:{width:40,type:"checkbox",selectedRowKeys:[],showCheckedAll:!0}}}),p=async()=>{const{data:d}=await k.getJudgementListApi({bankCateId:a.data.JudgementTagType.value,firstLabelId:a.data.firstLabel.value,secondLabelId:a.data.secondLabel.value,keyword:a.data.keyword,pageNum:i.data.pagination.pageNum,pageSize:i.data.pagination.pageSize}),{currentList:t,totalRecords:n}=d;i.data.list=t,i.data.pagination.total=n};U(()=>[a.data.JudgementTagType.value,a.data.firstLabel.value,a.data.secondLabel.value,a.data.keyword,i.data.pagination.pageSize],()=>{i.data.pagination.pageNum>1?i.data.pagination.pageNum=1:p()}),U(()=>i.data.pagination.pageNum,p);const _=d=>{const{instance:t,toggleVisible:n}=D({component:Y,props:{id:d},modalProps:{title:d?"编辑评判项":"添加评判项",draggable:!0,async onBeforeOk(){try{await t.value.submit()||(await k.addJudgementApi(t.value.form),z("success",{content:"添加成功"}),p(),n())}catch{return!1}}}})},x=d=>{j("warning",{title:"删除",content:"确认删除该评判项吗？",okText:"确认",hideCancel:!1,onOk:async()=>{try{await k.deleteJudgementApi(d),z("success",{content:"删除成功"}),p()}catch{z("error",{content:"删除失败"})}}})};return W(()=>{y(),p()}),(d,t)=>{const n=m("a-select"),s=m("a-space"),w=O,f=M,N=m("a-input-search"),h=m("a-link"),J=$;return q(),Q(X,null,[g("div",Z,[g("div",ee,[o(s,null,{default:c(()=>[o(n,{"model-value":e(a).data.JudgementTagType.value,"onUpdate:modelValue":t[0]||(t[0]=r=>e(a).data.JudgementTagType.value=r),options:e(a).data.JudgementTagType.options,"field-names":e(a).data.JudgementTagType.fieldNames,style:{width:"200px"},"allow-clear":"",placeholder:"选择评判标签类型",onChange:v},null,8,["model-value","options","field-names"]),o(n,{"model-value":e(a).data.firstLabel.value,"onUpdate:modelValue":t[1]||(t[1]=r=>e(a).data.firstLabel.value=r),options:e(a).data.firstLabel.options,"field-names":e(a).data.firstLabel.fieldNames,style:{width:"200px"},"allow-clear":"",placeholder:"选择一级标签",onChange:L},null,8,["model-value","options","field-names"]),o(n,{"model-value":e(a).data.secondLabel.value,"onUpdate:modelValue":t[2]||(t[2]=r=>e(a).data.secondLabel.value=r),options:e(a).data.secondLabel.options,"field-names":e(a).data.secondLabel.fieldNames,style:{width:"200px"},"allow-clear":"",placeholder:"选择二级标签"},null,8,["model-value","options","field-names"])]),_:1})]),g("div",ae,[o(s,null,{default:c(()=>[g("div",te,[o(s,null,{default:c(()=>[o(w,{type:"primary",onClick:t[3]||(t[3]=r=>_(""))},{default:c(()=>t[8]||(t[8]=[V(" 添加 ",-1)])),_:1,__:[8]})]),_:1})]),g("div",ne,[o(N,{"default-value":e(a).data.keyword,"allow-clear":"","search-button":"","button-text":"查询",placeholder:"输入关键字搜索",onChange:t[4]||(t[4]=r=>e(a).data.keyword=r)},{"button-icon":c(()=>[o(f,{icon:"icon-search"})]),_:1},8,["default-value"])])]),_:1})])]),o(J,{ref_key:"table",ref:C,"row-key":"id","selected-keys":e(i).data.tableRowSelection.selectedRowKeys,"onUpdate:selectedKeys":t[5]||(t[5]=r=>e(i).data.tableRowSelection.selectedRowKeys=r),"row-selection":e(i).data.tableRowSelection,columns:e(i).data.columns,data:e(i).data.list,pagination:e(i).data.pagination,"column-resizable":!0,onCurrentChange:t[6]||(t[6]=r=>e(i).data.pagination.pageNum=r),onPageSizeChange:t[7]||(t[7]=r=>e(i).data.pagination.pageSize=r)},{optional:c(({record:r})=>[o(s,{size:"medium"},{default:c(()=>[o(h,{status:"warning",hoverable:!1,onClick:S=>_(r.id)},{default:c(()=>t[9]||(t[9]=[V(" 编辑 ",-1)])),_:2,__:[9]},1032,["onClick"]),o(h,{status:"danger",hoverable:!1,onClick:S=>x(r.id)},{default:c(()=>t[10]||(t[10]=[V(" 删除 ",-1)])),_:2,__:[10]},1032,["onClick"])]),_:2},1024)]),_:1},8,["selected-keys","row-selection","columns","data","pagination"])],64)}}});export{ce as default};
