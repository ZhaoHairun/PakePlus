import{_ as O}from"./arco-icon-CunFPY5n.js";import{d as P,c as g,F as V,m as $,h as b,w as n,f as l,b as d,t as w,e as s,i as B,o as _,l as H,p as N,j as ee,a as R,q as ne,s as oe,u as m,v as te,x as U,_ as se}from"./index-B3mkc1PU.js";import{l as ae,i as le,s as ce}from"./index-DP0JwgWw.js";const re={key:0},ie={key:1},ue=P({__name:"menus",props:{menus:{default:()=>[]}},setup(j){return(x,C)=>{const f=O,K=l("a-menu-item"),M=l("a-sub-menu");return _(!0),g(V,null,$(x.menus,(a,I)=>{var y;return _(),g("div",{key:a.name},[a.children&&((y=a.children)==null?void 0:y.length)>0?(_(),g("div",re,[(_(),b(M,{key:a.name},{icon:n(()=>{var o;return[s(f,{icon:(o=a==null?void 0:a.meta)==null?void 0:o.icon,size:"18"},null,8,["icon"])]}),title:n(()=>{var o;return[B(w((o=a.meta)==null?void 0:o.title),1)]}),default:n(()=>[(_(!0),g(V,null,$(a.children,(o,k)=>(_(),b(K,{key:o.name},{icon:n(()=>{var c;return[s(f,{icon:(c=o==null?void 0:o.meta)==null?void 0:c.icon},null,8,["icon"])]}),default:n(()=>{var c;return[d("span",null,w((c=o.meta)==null?void 0:c.title),1)]}),_:2},1024))),128))]),_:2},1024))])):(_(),g("div",ie,[(_(),b(K,{key:a.name},{icon:n(()=>{var o;return[s(f,{icon:(o=a==null?void 0:a.meta)==null?void 0:o.icon,size:"18"},null,8,["icon"])]}),default:n(()=>{var o;return[d("span",null,w((o=a.meta)==null?void 0:o.title),1)]}),_:2},1024))]))])}),128)}}}),de={class:"main-container"},_e={class:"header-left"},me={class:"header-menu"},pe={class:"header-right"},fe={class:"role-btn-content"},ye={class:"avatar"},ve={class:"role-text"},he={class:"main-route-title"},ge=P({__name:"main",setup(j){const x=te(),C=ee(),f=H(),K=()=>{ce("warning",{title:"系统提示",content:"确认退出登录吗？",hideCancel:!1,onOk:()=>{H().reset(),C.replace({name:"login"})}})},M=N(()=>{const{role:t}=f.getUserInfo;if(!t)return[];const e=C.options.routes.find(r=>r.name==="main");return((e==null?void 0:e.children)||[]).filter(r=>{var v,p,h;return Array.isArray((v=r.meta)==null?void 0:v.roles)?((p=r.meta)==null?void 0:p.roles.includes(t))||((h=r.meta)==null?void 0:h.roles.includes("*")):!1})}),a=N(()=>{var i;const t=o.value[0];if(!t)return[];const e=(i=M.value)==null?void 0:i.find(r=>r.name===t);return e!=null&&e.children?I(e.children):[]}),I=t=>t.filter(e=>{var r,v,p,h;const i=((v=(r=e.meta)==null?void 0:r.roles)==null?void 0:v.includes(f.getUserInfo.role))||((h=(p=e.meta)==null?void 0:p.roles)==null?void 0:h.includes("*"));return!i||e.children&&(e.children=I(e.children),!e.children.length)?!1:i}),y=R([]),o=R([]),k=R([]),c=R([]),q=t=>{var i;const e=((i=a.value[0])==null?void 0:i.name)||t;if(!e)return!1;c.value=[e],C.replace({name:e})},D=t=>{C.replace({name:t})},z=()=>{const t=x.fullPath.split("/").slice(2);y.value=[t[0]],o.value=[t[0]],t.length<=1?(k.value=[t[0]],c.value=[t[0]]):(k.value=[t[t.length-2]],c.value=[t[t.length-1]])};return ne(()=>x.name,z),oe(()=>{z()}),(t,e)=>{const i=l("a-image"),r=O,v=l("a-menu-item"),p=l("a-menu"),h=l("icon-user"),E=l("icon-caret-down"),L=l("icon-lock"),A=l("a-doption"),T=l("icon-export"),G=l("a-dropdown-button"),J=l("a-layout-header"),Q=ue,W=l("a-layout-sider"),X=l("RouterView"),Y=l("a-layout-content"),F=l("a-layout"),Z=l("a-spin");return _(),g("div",de,[e[7]||(e[7]=d("div",{class:"main-top-color"},null,-1)),s(Z,{loading:m(ae)},{icon:n(()=>[s(i,{style:{"user-select":"none","pointer-events":"none","-webkit-user-drag":"none"},width:"200",src:m(le)("images/gif/loading.gif"),preview:!1},null,8,["src"])]),default:n(()=>[s(F,{class:"arco-layout-container"},{default:n(()=>[s(J,{class:"arco-layout-header"},{default:n(()=>[d("div",_e,[e[4]||(e[4]=d("div",{class:"header-logo"},null,-1)),d("div",me,[s(p,{mode:"horizontal","open-keys":m(y),"onUpdate:openKeys":e[0]||(e[0]=u=>U(y)?y.value=u:null),"selected-keys":m(o),"onUpdate:selectedKeys":e[1]||(e[1]=u=>U(o)?o.value=u:null),onMenuItemClick:q},{default:n(()=>[(_(!0),g(V,null,$(m(M),(u,ke)=>(_(),b(v,{key:u.name},{icon:n(()=>{var S;return[s(r,{style:{color:"white"},icon:(S=u.meta)==null?void 0:S.icon},null,8,["icon"])]}),default:n(()=>{var S;return[B(" "+w((S=u.meta)==null?void 0:S.title),1)]}),_:2},1024))),128))]),_:1},8,["open-keys","selected-keys"])])]),d("div",pe,[s(G,{shape:"round"},{icon:n(()=>[s(E)]),content:n(()=>[s(A,null,{icon:n(()=>[s(L)]),default:n(()=>[e[5]||(e[5]=B(" 修改密码 ",-1))]),_:1,__:[5]}),s(A,{onClick:K},{icon:n(()=>[s(T)]),default:n(()=>[e[6]||(e[6]=B(" 退出登录 ",-1))]),_:1,__:[6]})]),default:n(()=>[d("div",fe,[d("span",ye,[s(h)]),d("span",ve,w(m(f).getUserInfo.name),1)])]),_:1})])]),_:1}),s(F,{class:"arco-layout-main"},{default:n(()=>[s(W,{class:"arco-layout-sider",width:300},{default:n(()=>[s(p,{"open-keys":m(k),"onUpdate:openKeys":e[2]||(e[2]=u=>U(k)?k.value=u:null),"selected-keys":m(c),"onUpdate:selectedKeys":e[3]||(e[3]=u=>U(c)?c.value=u:null),accordion:!0,"auto-open-selected":!0,onMenuItemClick:D},{default:n(()=>[s(Q,{menus:m(a)},null,8,["menus"])]),_:1},8,["open-keys","selected-keys"])]),_:1}),s(Y,{class:"arco-layout-content"},{default:n(()=>[d("div",he,w(m(x).meta.title),1),s(X)]),_:1})]),_:1})]),_:1})]),_:1},8,["loading"])])}}}),Se=se(ge,[["__scopeId","data-v-62a584ab"]]);export{Se as default};
