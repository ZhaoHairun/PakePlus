import{_ as V}from"./arco-table-D7Ntzbsx.js";import{_ as B}from"./arco-icon-CunFPY5n.js";import{_ as L,u as U}from"./useRenderModal-BiI04mzw.js";import{b as y,J as I}from"./api-CmsgK-9p.js";import{l as $,s as F,a as C}from"./index-DP0JwgWw.js";import{d as S,a as M,r as v,s as R,B as O,f as i,h as W,o as z,w as s,e as n,u as t,y as q,q as N,c as D,b as _,F as K,i as x}from"./index-B3mkc1PU.js";const j=S({__name:"add-label-1",props:{id:{default:""}},setup(J,{expose:l}){const w=J,g=M(),a=v({data:{form:{id:"",level:1,parentId:"",code:"",content:"",bankCateId:""},rules:{code:[{required:!0,message:"请输入编号"}],content:[{required:!0,message:"请输入内容"}],bankCateId:[{required:!0,message:"请选择评判标签类型"}]}}}),r=async()=>{const{data:o}=await y.getJudgementTagDetailApi(w.id);Object.assign(a.data.form,{id:o.id,level:o.level,parentId:o.parentId,code:o.code,content:o.content,bankCateId:o.bankCateId})},p=v({data:{options:[],fieldNames:{label:"name",value:"id"}}}),T=async()=>{const{data:o}=await I.getJudgementTagTypeListApi({keyword:"",pageNum:1,pageSize:9999});p.data.options=o.currentList};return l({form:a.data.form,async submit(){return await g.value.validate()}}),R(()=>{T(),w.id&&r()}),O(()=>{g.value.resetFields(Object.keys(a.data.form))}),(o,e)=>{const c=i("a-select"),m=i("a-form-item"),f=i("a-input"),k=i("a-textarea"),h=i("a-form"),b=i("a-scrollbar");return z(),W(b,{style:{maxHeight:"calc(100vh - 250px)",overflow:"auto"}},{default:s(()=>[n(h,{ref_key:"form",ref:g,model:t(a).data.form,rules:t(a).data.rules,disabled:t($),"auto-label-width":"","scroll-to-first-error":""},{default:s(()=>[n(m,{label:"评判标签类型",field:"bankCateId"},{default:s(()=>[n(c,{"model-value":t(a).data.form.bankCateId,"onUpdate:modelValue":e[0]||(e[0]=u=>t(a).data.form.bankCateId=u),options:t(p).data.options,"field-names":t(p).data.fieldNames,"allow-clear":"",placeholder:"请选择评判标签类型"},null,8,["model-value","options","field-names"])]),_:1}),n(m,{label:"编号",field:"code"},{default:s(()=>[n(f,{"model-value":t(a).data.form.code,"onUpdate:modelValue":e[1]||(e[1]=u=>t(a).data.form.code=u),placeholder:"编号"},null,8,["model-value"])]),_:1}),n(m,{label:"内容",field:"content"},{default:s(()=>[n(k,{"model-value":t(a).data.form.content,"onUpdate:modelValue":e[2]||(e[2]=u=>t(a).data.form.content=u),"auto-size":{minRows:2,maxRows:10},"allow-clear":"",placeholder:"内容"},null,8,["model-value"])]),_:1})]),_:1},8,["model","rules","disabled"])]),_:1})}}}),E={class:"filter-content"},P={class:"select-content"},H={class:"search-content"},G={class:"search-content-buttons"},Q={class:"search"},oe=S({__name:"label-1",setup(J){const l=v({data:{JudgementTagType:{fieldNames:{label:"name",value:"id"},options:[],value:""},keyword:""}}),w=async()=>{const{data:o}=await I.getJudgementTagTypeListApi({keyword:"",pageNum:1,pageSize:9999});l.data.JudgementTagType.options=o.currentList},g=q("table"),a=v({data:{columns:[{title:"标签编号",dataIndex:"code",align:"center",width:100,minWidth:100},{title:"标签内容",dataIndex:"content",align:"center",minWidth:200},{title:"评判标签类型",dataIndex:"bankCateName",align:"center",width:200,minWidth:200},{title:"添加时间",dataIndex:"createTime",align:"center",width:200,minWidth:200},{title:"操作",slotName:"optional",align:"center",fixed:"right",width:200,minWidth:200}],list:[],pagination:{show:!0,total:0,pageNum:1,pageSize:10},tableRowSelection:{width:40,type:"checkbox",selectedRowKeys:[],showCheckedAll:!0}}}),r=async()=>{const{data:o}=await y.getJudgementTagListApi({level:"1",bankCateId:l.data.JudgementTagType.value,keyword:l.data.keyword,pageNum:a.data.pagination.pageNum,pageSize:a.data.pagination.pageSize}),{currentList:e,totalRecords:c}=o;a.data.list=e,a.data.pagination.total=c};N(()=>[l.data.JudgementTagType.value,l.data.keyword,a.data.pagination.pageSize],()=>{a.data.pagination.pageNum>1?a.data.pagination.pageNum=1:r()}),N(()=>a.data.pagination.pageNum,r);const p=o=>{const{instance:e,toggleVisible:c}=U({component:j,props:{id:o},modalProps:{title:o?"编辑评判项标签":"添加评判项标签",draggable:!0,async onBeforeOk(){try{await e.value.submit()||(await y.addJudgementTagApi(e.value.form),C("success",{content:"添加成功"}),r(),c())}catch{return!1}}}})},T=o=>{F("warning",{title:"删除",content:"确认删除该评判项标签吗？",okText:"确认",hideCancel:!1,onOk:async()=>{try{await y.deleteJudgementTagApi(o),C("success",{content:"删除成功"}),r()}catch{C("error",{content:"删除失败"})}}})};return R(()=>{w(),r()}),(o,e)=>{const c=i("a-select"),m=L,f=i("a-space"),k=B,h=i("a-input-search"),b=i("a-link"),u=V;return z(),D(K,null,[_("div",E,[_("div",P,[n(c,{"model-value":t(l).data.JudgementTagType.value,"onUpdate:modelValue":e[0]||(e[0]=d=>t(l).data.JudgementTagType.value=d),options:t(l).data.JudgementTagType.options,"field-names":t(l).data.JudgementTagType.fieldNames,style:{width:"200px"},"allow-clear":"",placeholder:"选择评判标签类型"},null,8,["model-value","options","field-names"])]),_("div",H,[n(f,null,{default:s(()=>[_("div",G,[n(f,null,{default:s(()=>[n(m,{type:"primary",onClick:e[1]||(e[1]=d=>p(""))},{default:s(()=>e[6]||(e[6]=[x(" 添加 ",-1)])),_:1,__:[6]})]),_:1})]),_("div",Q,[n(h,{"default-value":t(l).data.keyword,"allow-clear":"","search-button":"","button-text":"查询",placeholder:"输入关键字搜索",onChange:e[2]||(e[2]=d=>t(l).data.keyword=d)},{"button-icon":s(()=>[n(k,{icon:"icon-search"})]),_:1},8,["default-value"])])]),_:1})])]),n(u,{ref_key:"table",ref:g,"row-key":"id","selected-keys":t(a).data.tableRowSelection.selectedRowKeys,"onUpdate:selectedKeys":e[3]||(e[3]=d=>t(a).data.tableRowSelection.selectedRowKeys=d),"row-selection":t(a).data.tableRowSelection,columns:t(a).data.columns,data:t(a).data.list,pagination:t(a).data.pagination,"column-resizable":!0,onCurrentChange:e[4]||(e[4]=d=>t(a).data.pagination.pageNum=d),onPageSizeChange:e[5]||(e[5]=d=>t(a).data.pagination.pageSize=d)},{optional:s(({record:d})=>[n(f,{size:"medium"},{default:s(()=>[n(b,{status:"warning",hoverable:!1,onClick:A=>p(d.id)},{default:s(()=>e[7]||(e[7]=[x(" 编辑 ",-1)])),_:2,__:[7]},1032,["onClick"]),n(b,{status:"danger",hoverable:!1,onClick:A=>T(d.id)},{default:s(()=>e[8]||(e[8]=[x(" 删除 ",-1)])),_:2,__:[8]},1032,["onClick"])]),_:2},1024)]),_:1},8,["selected-keys","row-selection","columns","data","pagination"])],64)}}});export{oe as default};
