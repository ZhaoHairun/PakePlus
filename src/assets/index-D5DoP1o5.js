import{_ as B}from"./arco-table-D7Ntzbsx.js";import{_ as V}from"./arco-icon-CunFPY5n.js";import{_ as $,u as F}from"./useRenderModal-BiI04mzw.js";import{l as M,s as O,a as h}from"./index-DP0JwgWw.js";import{K as w,C as R}from"./api-CmsgK-9p.js";import{d as S,a as U,r as v,s as I,B as D,f as i,h as L,o as z,w as d,e as n,u as t,y as W,q as K,c as q,b as y,F as j,i as x}from"./index-B3mkc1PU.js";const P=S({__name:"add",props:{id:{default:""}},setup(N,{expose:s}){const g=N,f=U(),a=v({data:{form:{id:"",typeCodeId:"",name:""},rules:{typeCodeId:[{required:!0,message:"请选择关键词类型"}],name:[{required:!0,message:"请输入关键词内容"}]}}}),r=async()=>{const{data:o}=await w.getKeywordDetailApi(g.id);Object.assign(a.data.form,{id:o.id,typeCodeId:o.typeCodeId,name:o.name})},m=v({data:{options:[],fieldNames:{value:"id",label:"name"}}}),b=async()=>{const{data:o}=await R.commonCodeApi("关键词类型");m.data.options=o.currentList};return s({form:a.data.form,async submit(){return await f.value.validate()}}),I(()=>{b(),g.id&&r()}),D(()=>{f.value.resetFields(Object.keys(a.data.form))}),(o,e)=>{const c=i("a-select"),p=i("a-form-item"),_=i("a-textarea"),C=i("a-form"),k=i("a-scrollbar");return z(),L(k,{style:{maxHeight:"calc(100vh - 250px)",overflow:"auto"}},{default:d(()=>[n(C,{ref_key:"form",ref:f,model:t(a).data.form,rules:t(a).data.rules,disabled:t(M),"auto-label-width":"","scroll-to-first-error":""},{default:d(()=>[n(p,{label:"关键词类型",field:"typeCodeId"},{default:d(()=>[n(c,{"model-value":t(a).data.form.typeCodeId,"onUpdate:modelValue":e[0]||(e[0]=u=>t(a).data.form.typeCodeId=u),options:t(m).data.options,"field-names":t(m).data.fieldNames,"allow-clear":"",placeholder:"请选择关键词类型"},null,8,["model-value","options","field-names"])]),_:1}),n(p,{label:"关键词内容",field:"name"},{default:d(()=>[n(_,{"model-value":t(a).data.form.name,"onUpdate:modelValue":e[1]||(e[1]=u=>t(a).data.form.name=u),"auto-size":{minRows:2,maxRows:10},"allow-clear":"",placeholder:"请输入关键词内容"},null,8,["model-value"])]),_:1})]),_:1},8,["model","rules","disabled"])]),_:1})}}}),E={class:"filter-content"},H={class:"select-content"},G={class:"search-content"},J={class:"search-content-buttons"},Q={class:"search"},oe=S({__name:"index",setup(N){const s=v({data:{type:{fieldNames:{value:"id",label:"name"},options:[],value:""},keyword:""}}),g=async()=>{const{data:o}=await R.commonCodeApi("关键词类型");s.data.type.options=o.currentList},f=W("table"),a=v({data:{columns:[{title:"关键词类型",dataIndex:"typeCodeName",align:"center",minWidth:200},{title:"关键词内容",dataIndex:"name",align:"center",minWidth:200},{title:"添加时间",dataIndex:"createTime",align:"center",minWidth:200},{title:"操作",slotName:"optional",align:"center",fixed:"right",minWidth:200}],list:[],pagination:{show:!0,total:0,pageNum:1,pageSize:10},tableRowSelection:{width:40,type:"checkbox",selectedRowKeys:[],showCheckedAll:!0}}}),r=async()=>{const{data:o}=await w.getKeywordListApi({typeCodeId:s.data.type.value,keyword:s.data.keyword,pageNum:a.data.pagination.pageNum,pageSize:a.data.pagination.pageSize}),{currentList:e,totalRecords:c}=o;a.data.list=e,a.data.pagination.total=c};K(()=>[s.data.type.value,s.data.keyword,a.data.pagination.pageSize],()=>{a.data.pagination.pageNum>1?a.data.pagination.pageNum=1:r()}),K(()=>a.data.pagination.pageNum,r);const m=o=>{const{instance:e,toggleVisible:c}=F({component:P,props:{id:o},modalProps:{title:`${o?"编辑":"添加"}关键词`,draggable:!0,async onBeforeOk(){try{await e.value.submit()||(await w.addKeywordApi(e.value.form),h("success",{content:"添加成功"}),r(),c())}catch{return!1}}}})},b=o=>{O("warning",{title:"删除",content:"确认删除该关键词吗？",okText:"确认",hideCancel:!1,onOk:async()=>{try{await w.deleteKeywordApi(o),h("success",{content:"删除成功"}),r()}catch{h("error",{content:"删除失败"})}}})};return I(()=>{g(),r()}),(o,e)=>{const c=i("a-select"),p=$,_=i("a-space"),C=V,k=i("a-input-search"),u=i("a-link"),T=B;return z(),q(j,null,[y("div",E,[y("div",H,[n(c,{"model-value":t(s).data.type.value,"onUpdate:modelValue":e[0]||(e[0]=l=>t(s).data.type.value=l),options:t(s).data.type.options,"field-names":t(s).data.type.fieldNames,style:{width:"200px"},"allow-clear":"",placeholder:"选择关键词类型"},null,8,["model-value","options","field-names"])]),y("div",G,[n(_,null,{default:d(()=>[y("div",J,[n(_,null,{default:d(()=>[n(p,{type:"primary",onClick:e[1]||(e[1]=l=>m(""))},{default:d(()=>e[6]||(e[6]=[x(" 添加 ",-1)])),_:1,__:[6]})]),_:1})]),y("div",Q,[n(k,{"default-value":t(s).data.keyword,"allow-clear":"","search-button":"","button-text":"查询",placeholder:"输入关键字搜索",onChange:e[2]||(e[2]=l=>t(s).data.keyword=l)},{"button-icon":d(()=>[n(C,{icon:"icon-search"})]),_:1},8,["default-value"])])]),_:1})])]),n(T,{ref_key:"table",ref:f,"row-key":"id","selected-keys":t(a).data.tableRowSelection.selectedRowKeys,"onUpdate:selectedKeys":e[3]||(e[3]=l=>t(a).data.tableRowSelection.selectedRowKeys=l),"row-selection":t(a).data.tableRowSelection,columns:t(a).data.columns,data:t(a).data.list,pagination:t(a).data.pagination,"column-resizable":!0,onCurrentChange:e[4]||(e[4]=l=>t(a).data.pagination.pageNum=l),onPageSizeChange:e[5]||(e[5]=l=>t(a).data.pagination.pageSize=l)},{optional:d(({record:l})=>[n(_,{size:"medium"},{default:d(()=>[n(u,{status:"warning",hoverable:!1,onClick:A=>m(l.id)},{default:d(()=>e[7]||(e[7]=[x(" 编辑 ",-1)])),_:2,__:[7]},1032,["onClick"]),n(u,{status:"danger",hoverable:!1,onClick:A=>b(l.id)},{default:d(()=>e[8]||(e[8]=[x(" 删除 ",-1)])),_:2,__:[8]},1032,["onClick"])]),_:2},1024)]),_:1},8,["selected-keys","row-selection","columns","data","pagination"])],64)}}});export{oe as default};
